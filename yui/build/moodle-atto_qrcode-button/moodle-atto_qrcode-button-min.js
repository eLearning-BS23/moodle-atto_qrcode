YUI.add("moodle-atto_qrcode-button",function(r,e){var t="atto_qrcode",n='<form class="mform atto_form atto_qrcode" id="atto_qrcode_form"><label for="qrcodecontent">'+M.str.atto_qrcode.qrcodecontent+'</label><input class="form-control fullwidth " type="text" id="qrcodecontent"required="true"/><label for="qrcode_size">'+M.str.atto_qrcode.qrcode_size+'</label><input class="form-control fullwidth " type="number" id="qrcode_size"required="true" size="10" value="{{qrcode_size_default}}" min="5" max="100000"/><label for="qrcode_margin">'+M.str.atto_qrcode.qrcode_margin+'</label><input class="form-control fullwidth " type="number" id="qrcode_margin"size="10"  min="5" max="100" required="true" value="{{qrcode_margin_default}}"/><div class="clearfix"></div><div class="mdl-align"><br><button class="btn btn-secondary submit" type="submit">'+M.str.atto_qrcode.insertqrcode+"</button></div></form>";r.use("core/event").namespace("M.atto_qrcode").Button=r.Base.create("button",r.M.editor_atto.EditorPlugin,[],{_currentSelection:null,initializer:function(){this.get("disabled")||this.addButton({icon:"qrcode",iconComponent:t,callback:this._handleQrCodeGenerator,callbackArgs:"qrcode"})},_handleQrCodeGenerator:function(){this.getDialogue({headerContent:M.util.get_string("insertqrcode",t),focusAfterHide:!0,width:660}).set("bodyContent",this._getDialogueContent(this.get("host").getSelection())).show()},_getDialogueContent:function(e){var t={qrcode_size_default:300,qrcode_margin_default:10},o=r.Node.create(r.Handlebars.compile(n)(t));return this._attachEvents(o,e)},_attachEvents:function(e,c){return e.one(".submit").on("click",function(e){var t,o,r=e.currentTarget.ancestor(".atto_form"),n=r.one("#qrcodecontent").get("value"),i=r.one("#qrcode_size").get("value"),a=r.one("#qrcode_margin").get("value");n&&i&&a&&(console.log(n),console.log(i),console.log(a),e.preventDefault(),t=this._getMediaHTMLQrcode(n,i,a),o=this.get("host"),this.getDialogue({focusAfterHide:null}).hide(),t&&(o.setSelection(c),o.insertContentAtFocusPoint(t),this.markUpdated()))},this),e},_getMediaHTMLQrcode:function(e,t,o){this._getQrCode();return r.Handlebars.compile('<img src="{{base64qrcode}}" alt="" />')({base64qrcode:"base64qrcode"})},_getQrCode:function(){r.io(M.cfg.wwwroot+"/lib/editor/atto/plugins/qrcode/ajax.php",{context:this,data:{sesskey:M.cfg.sesskey,contextid:this.get("contextid")},timeout:500,on:{complete:this._handaleQrCodeAjaxCall}})},_handaleQrCodeNetworkCall:function(e,t){console.log(e),console.log(t)}},{ATTRS:{disabled:{value:!1},contextid:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});